{"remainingRequest":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\babel-loader\\lib\\index.js!D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\MyProjects\\HbuilderX-projects\\2.19z\\src\\components\\editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\src\\components\\editor.vue","mtime":1587095643612},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1582103017138},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\babel-loader\\lib\\index.js","mtime":1582103090028},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1582103017138},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1582103017138},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\babel-loader\\lib\\index.js","mtime":1582103090028},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1582103017138},{"path":"D:\\MyProjects\\HbuilderX-projects\\2.19z\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport tinymce from 'tinymce/tinymce';\nimport Editor from '@tinymce/tinymce-vue';\nimport 'tinymce/themes/silver'; // 编辑器插件plugins\n// 更多插件参考：https://www.tiny.cloud/docs/plugins/\n\nimport 'tinymce/plugins/image'; // 插入上传图片插件\n\nimport 'tinymce/plugins/media'; // 插入视频插件\n\nimport 'tinymce/plugins/table'; // 插入表格插件\n\nimport 'tinymce/plugins/lists'; // 列表插件\n\nimport 'tinymce/plugins/wordcount'; // 字数统计插件\n\nimport 'tinymce/plugins/link'; // 超链接\n\nimport 'tinymce/plugins/code'; //\n\nexport default {\n  components: {\n    Editor: Editor\n  },\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    // 基本路径，默认为空根目录，如果你的项目发布后的地址为目录形式，\n    // 即abc.com/tinymce，baseUrl需要配置成tinymce，不然发布后资源会找不到\n    baseUrl: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    plugins: {\n      type: [String, Array],\n      default: 'lists link code table wordcount' // default: 'lists image media table wordcount'\n\n    },\n    toolbar: {\n      type: [String, Array],\n      default: 'undo redo |  formatselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists link  table | removeformat' // default: 'undo redo |  formatselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists image media table | removeformat'\n\n    }\n  },\n  data: function data() {\n    return {\n      myBlog: {\n        title: \"\",\n        flag: false\n      },\n      list: [],\n      //数据库里当前用户的所有分类\n      classify: \"\",\n      //新建的分类名\n      classname: \"\",\n      //当前点击的分类名\n      cid: \"\",\n      //分类表id\n      bid: \"\",\n      //所点击修改的博客的bid（如果为0 的话，返回全空的editor）\n      blogvo: {},\n      //存储修改的博客\n      loginUid: localStorage.getItem(\"login\"),\n      init: {\n        language_url: \"/zh_CN.js\",\n        language: 'zh_CN',\n        skin_url: \"/skins/ui/oxide\",\n        content_css: \"/skins/content/default/content.css\",\n        height: 800,\n        plugins: this.plugins,\n        toolbar: this.toolbar,\n        branding: false,\n        menubar: false,\n        // 此处为图片上传处理函数，这个直接用了base64的图片形式上传图片，\n        // 如需ajax上传可参考https://www.tiny.cloud/docs/configure/file-image-upload/#images_upload_handler\n        images_upload_handler: function images_upload_handler(blobInfo, success, failure) {\n          var img = 'data:image/jpeg;base64,' + blobInfo.base64();\n          success(img);\n        }\n      },\n      myValue: this.value\n    };\n  },\n  //  watch: {\n  // value (newValue) {\n  // \tthis.myValue = newValue;\n  // },\n  // myValue (newValue) {\n  // \tthis.$emit('input', newValue);\n  // }\n  //  }\n  mounted: function mounted() {\n    //初始化富文本编辑器\n    tinymce.init({}), //检查是不是点击 “编辑” 所返回的editor\n    this.bid = this.$router.history.current.params.blogId; // console.log(this.bid);\n    //获取当前修改的博客\n\n    if (this.bid == 0) {\n      //是要写博客\n      this.myBlog.title = \"\";\n      this.myValue = \"\";\n      this.classname = \"\";\n    } else {\n      //获取当前修改的博客\n      this.getModifyBlog();\n    }\n  },\n  methods: {\n    //获取当前修改的博客\n    getModifyBlog: function getModifyBlog() {\n      var _this = this;\n\n      var data = {\n        id: this.bid\n      };\n      this.$ajax.post('/api/blog/queryBlogVo', this.$qs.stringify(data)).then(function (response) {\n        _this.blogvo = response.data; //各单位\t\t赋值\n\n        _this.myBlog.title = _this.blogvo.title; // console.log(this.blogvo);\n\n        _this.myValue = _this.blogvo.content;\n        _this.classname = _this.blogvo.classname;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    // 添加相关的事件，可用的事件参照文档=> https://github.com/tinymce/tinymce-vue => All available events\n    // 需要什么事件可以自己增加\n    onClick: function onClick(e) {\n      this.$emit('onClick', e, tinymce);\n    },\n    modelOut: function modelOut() {\n      //点击发布博客，弹出模态框，并验证标题、内容是否为空\n      var title = this.myBlog.title;\n      var content = this.myValue; // var that = this;\n\n      if (!title) {\n        // console.log(\"标题-----\"+title);\n        this.myBlog.flag = true; // console.log(this.myBlog.flag);\n      } else if (!content) {\n        alert(\"博客内容不能为空\");\n      } else {\n        $('#myModal').modal('show'); //模态框显示\n\n        this.queryAllClass(); //调用查看全部分类\n      }\n    },\n    //新建分类名\n    addClassify: function addClassify() {\n      var _this2 = this;\n\n      var data = {\n        uid: localStorage.getItem(\"login\"),\n        classname: this.classify // console.log(\"新建分类----------------\"+data);\n\n      };\n      this.$ajax.post('/api/classify/addClassify', this.$qs.stringify(data)).then(function (response) {\n        // console.log(response.data);\n        alert(\"创建成功\");\n        _this2.classify = \"\"; // this.$router.go(-1);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    //获取当前点击的分类名\n    getClassname: function getClassname(event) {\n      var _this3 = this;\n\n      this.queryAllClass();\n      this.classname = event.target.value;\n\n      if (this.classname == \"请选择\") {\n        alert(\"请选择分类\");\n      } // console.log(\"点击的分类名\"+this.classname);\n\n\n      var data = {\n        classname: this.classname,\n        uid: localStorage.getItem(\"login\") // console.log(\"data-------------------\"+data);\n\n      };\n      this.$ajax.post('/api/classify/getCid', this.$qs.stringify(data)).then(function (response) {\n        console.log(\"cid-----\" + response.data);\n        _this3.cid = response.data;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    // 测试看看显示不显示新添加的\n    queryAllClass: function queryAllClass() {\n      var _this4 = this;\n\n      console.log(\"queryAllClass被点击----------\");\n      var data = {\n        uid: localStorage.getItem(\"login\")\n      };\n      console.log(\"data------------------------\" + data); //测试获取后端分类list\n\n      this.$ajax.post('/api/classify/allClassify', this.$qs.stringify(data)).then(function (response) {\n        // console.log(response.data);\n        _this4.list = response.data;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    sell: function sell() {\n      //点击发布文章\n      //获取分类名的对应id\n      if (!this.classname) {\n        alert(\"请选择分类\");\n        return;\n      }\n\n      if (this.bid == 0) {\n        //新增博客\n        this.sellAddBlog();\n      } else {\n        //修改博客\n        this.updateBlog();\n      }\n\n      $('#myModal').modal('hide'); //模态框隐藏\n\n      var that = this; // that.$router.push(`myBlogCenter${this.loginUid}`);\n\n      this.$router.go(-1);\n    },\n    //编辑博客后的更新博客\n    updateBlog: function updateBlog() {\n      var _this5 = this;\n\n      var data = {\n        id: this.bid,\n        // userId:localStorage.getItem(\"login\"),\n        title: this.myBlog.title,\n        content: this.myValue,\n        cid: this.cid\n      };\n      this.$ajax.post('/api/blog/updateBlog', this.$qs.stringify(data)).then(function (response) {\n        // console.log(\"====================\");\n        // this.$router.push(`myBlogCenter${this.loginUid}`);\n        _this5.$router.go(-1);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    //----新增博客\n    sellAddBlog: function sellAddBlog() {\n      //新增博客\n      console.log(\"新增博客-------\");\n      var title = this.myBlog.title;\n      var content = this.myValue;\n      var cId = this.cid; // console.log(\"cId--------\"+cId);\n\n      var data = {\n        userId: localStorage.getItem(\"login\"),\n        title: title,\n        content: content,\n        cid: cId\n      };\n      this.$ajax.post('/api/blog/addBlog', this.$qs.stringify(data)).then(function (response) {\n        alert(\"发布成功\");\n      }).catch(function (error) {\n        console.log(error);\n      });\n    }\n  }\n};",{"version":3,"sources":["editor.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t\n\t<div class=\"tinymce-editor\" id=\"tinymce-editor\">\r\n\t\t\r\n\t\t<!-- <div> -->\r\n\t\t\t<form class=\"editor-form\" v-model=\"myBlog\" onsubmit=\"return false\">\r\n\t\t\t\t<!-- <span>返回</span> -->\r\n\t\t\t\t<span v-show=\"myBlog.flag\">标题不能为空</span>\r\n\t\t\t\t<input type=\"text\" v-model.trim=\"myBlog.title\" placeholder=\"请输入标题\" class=\"editor-title\"/>\r\n\t\t\t\t<input @click=\"modelOut\"  type=\"button\" value=\"发布博客\" class=\"editor-btnOut btn btn-primary\" />\r\n\t\t\t</form>\r\n\t\t<!-- </div> -->\r\n\t\t\r\n\t\t<!-- 模态框（Modal） -->\r\n\t\t<div class=\"modal fade\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n\t\t    <div class=\"modal-dialog\">\r\n\t\t        <div class=\"modal-content\">\r\n\t\t            <div class=\"modal-header\">\r\n\t\t                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">&times;</button>\r\n\t\t                <h4 class=\"modal-title\" id=\"myModalLabel\">发布文章</h4>\r\n\t\t            </div>\r\n\t\t            <div class=\"modal-body\">\r\n\t\t\t\t\t\t<div class=\"form-group form-mygroup\">\r\n\t\t\t\t\t\t    <label class=\"col-sm-2 control-label modal-blogclassname\">博客分类</label>\r\n\t\t\t\t\t\t    <div class=\"col-sm-10\">\r\n\t\t\t\t\t\t      <input v-model.trim=\"classify\" type=\"text\" class=\"form-control \" id=\"classnameId\" placeholder=\"创建新分类\">\r\n\t\t\t\t\t\t\t  <button type=\"button\" class=\"btn btn-primary btn-confirm\" @click=\"addClassify\">确定</button>\r\n\t\t\t\t\t\t    </div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"form-group form-mygroup\">\r\n\t\t\t\t\t\t\t<label class=\"col-sm-2 control-label modal-blogclassname\">选择已有</label>\r\n\t\t\t\t\t\t\t<select class=\"dropmenu form-control\"  id=\"selectclass\" @change=\"getClassname($event)\">\r\n\t\t\t\t\t\t\t\t<option>请选择</option>\r\n\t\t\t\t\t\t\t\t<option  v-for=\"(item,index) in list\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t  {{item}}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t            <div class=\"modal-footer\">\r\n\t\t                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">关闭</button>\r\n\t\t                <button type=\"button\" class=\"btn btn-primary\" @click=\"sell\">发布文章</button>\r\n\t\t            </div>\r\n\t\t        </div><!-- /.modal-content -->\r\n\t\t    </div><!-- /.modal -->\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class=\"editor-help\"></div><!-- 没用的div，作用是把编辑器压下去 -->\n\t\t<editor v-model.trim=\"myValue\"\n\t\t\t:init=\"init\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t@onClick=\"onClick\">\n\t\t</editor>\n\t</div>\n</template>\n<script>\nimport tinymce from 'tinymce/tinymce'\nimport Editor from '@tinymce/tinymce-vue'\nimport 'tinymce/themes/silver'\n// 编辑器插件plugins\n// 更多插件参考：https://www.tiny.cloud/docs/plugins/\nimport 'tinymce/plugins/image'// 插入上传图片插件\nimport 'tinymce/plugins/media'// 插入视频插件\nimport 'tinymce/plugins/table'// 插入表格插件\nimport 'tinymce/plugins/lists'// 列表插件\nimport 'tinymce/plugins/wordcount'// 字数统计插件\r\nimport 'tinymce/plugins/link'// 超链接\r\nimport 'tinymce/plugins/code'\t//\nexport default {\n  components: {\n    Editor\n  },\n  props: {\n    value: {\n      type: String,\n      default: ''\n    },\n    // 基本路径，默认为空根目录，如果你的项目发布后的地址为目录形式，\n    // 即abc.com/tinymce，baseUrl需要配置成tinymce，不然发布后资源会找不到\n    baseUrl: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    plugins: {\n      type: [String, Array],\r\n\t  default: 'lists link code table wordcount'\n      // default: 'lists image media table wordcount'\n    },\n    toolbar: {\n\t\ttype: [String, Array],\n\t\tdefault: 'undo redo |  formatselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists link  table | removeformat'\n\t\t// default: 'undo redo |  formatselect | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | lists image media table | removeformat'\r\n\t\t    \r\n\t}\r\n\t\n  },\n  data () {\n    return {\r\n\t\tmyBlog:{\r\n\t\t\ttitle:\"\",\r\n\t\t\tflag:false,\r\n\t\t},\r\n\t\tlist:[],\t//数据库里当前用户的所有分类\r\n\t\tclassify:\"\",\t//新建的分类名\r\n\t\tclassname:\"\",\t//当前点击的分类名\r\n\t\tcid:\"\",\t\t//分类表id\r\n\t\tbid:\"\",\t\t//所点击修改的博客的bid（如果为0 的话，返回全空的editor）\r\n\t\tblogvo:{},\t//存储修改的博客\r\n\t\tloginUid:localStorage.getItem(\"login\"),\n\t\tinit: {\n\t\t\tlanguage_url: \"/zh_CN.js\",\n\t\t\tlanguage: 'zh_CN',\n\t\t\tskin_url: \"/skins/ui/oxide\",\n\t\t\tcontent_css: \"/skins/content/default/content.css\",\r\n\t\t\theight: 800,\n\t\t\tplugins: this.plugins,\n\t\t\ttoolbar: this.toolbar,\n\t\t\tbranding: false,\n\t\t\tmenubar: false,\n\t\t\t// 此处为图片上传处理函数，这个直接用了base64的图片形式上传图片，\n\t\t\t// 如需ajax上传可参考https://www.tiny.cloud/docs/configure/file-image-upload/#images_upload_handler\n\t\t\timages_upload_handler: (blobInfo, success, failure) => {\n\t\t\t\tconst img = 'data:image/jpeg;base64,' + blobInfo.base64()\n\t\t\t\tsuccess(img)\n\t\t\t}\n\t\t},\n\t\tmyValue: this.value\n    }\n  },\r\n //  watch: {\r\n\t// value (newValue) {\r\n\t// \tthis.myValue = newValue;\r\n\t// },\r\n\t// myValue (newValue) {\r\n\t// \tthis.$emit('input', newValue);\r\n\t// }\r\n //  }\n  mounted () {\r\n\t//初始化富文本编辑器\n    tinymce.init({}),\r\n\t//检查是不是点击 “编辑” 所返回的editor\r\n\tthis.bid = this.$router.history.current.params.blogId;\r\n\t// console.log(this.bid);\r\n\t//获取当前修改的博客\r\n\tif(this.bid == 0){\r\n\t\t//是要写博客\r\n\t\tthis.myBlog.title = \"\";\r\n\t\tthis.myValue = \"\";\r\n\t\tthis.classname = \"\";\t\r\n\t}\r\n\telse{\r\n\t\t//获取当前修改的博客\r\n\t\tthis.getModifyBlog();\r\n\t}\n  },\n  methods: {\r\n\t//获取当前修改的博客\r\n\tgetModifyBlog(){\r\n\t\tlet data={\r\n\t\t\tid:this.bid,\r\n\t\t}\r\n\t\tthis.$ajax.post('/api/blog/queryBlogVo', this.$qs.stringify(data))\r\n\t\t.then(response =>{\r\n\t\t\tthis.blogvo = response.data;\r\n\t\t\t//各单位\t\t赋值\r\n\t\t\tthis.myBlog.title = this.blogvo.title;\r\n\t\t\t// console.log(this.blogvo);\r\n\t\t\tthis.myValue = this.blogvo.content;\r\n\t\t\tthis.classname = this.blogvo.classname;\r\n\t\t})\r\n\t\t.catch(error =>{\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t},\r\n\t\n    // 添加相关的事件，可用的事件参照文档=> https://github.com/tinymce/tinymce-vue => All available events\n    // 需要什么事件可以自己增加\n    onClick (e) {\n      this.$emit('onClick', e, tinymce)\n    },\r\n\tmodelOut(){\t\t//点击发布博客，弹出模态框，并验证标题、内容是否为空\r\n\t\tvar title = this.myBlog.title;\r\n\t\tvar content = this.myValue;\r\n\t\t// var that = this;\r\n\t\tif(!title){\r\n\t\t\t// console.log(\"标题-----\"+title);\r\n\t\t\tthis.myBlog.flag = true;\r\n\t\t\t// console.log(this.myBlog.flag);\r\n\t\t\t\r\n\t\t}\r\n\t\telse if(!content){\r\n\t\t\talert(\"博客内容不能为空\");\r\n\t\t}\r\n\t\telse{\r\n\t\t\t$('#myModal').modal('show');\t//模态框显示\r\n\t\t\tthis.queryAllClass();\t//调用查看全部分类\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t//新建分类名\r\n\taddClassify(){\r\n\t\tlet data = {\r\n\t\t\tuid:localStorage.getItem(\"login\"),\r\n\t\t\tclassname:this.classify,\r\n\t\t}\r\n\t\t// console.log(\"新建分类----------------\"+data);\r\n\t\tthis.$ajax.post('/api/classify/addClassify', this.$qs.stringify(data))\r\n\t\t.then(response => {\r\n\t\t\t// console.log(response.data);\r\n\t\t\talert(\"创建成功\");\r\n\t\t\tthis.classify=\"\";\r\n\t\t\t// this.$router.go(-1);\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t},\r\n\t//获取当前点击的分类名\r\n\tgetClassname(event){\r\n\t\tthis.queryAllClass();\r\n\t\tthis.classname = event.target.value;\r\n\t\tif(this.classname==\"请选择\"){\r\n\t\t\talert(\"请选择分类\");\r\n\t\t}\r\n\t\t// console.log(\"点击的分类名\"+this.classname);\r\n\t\tlet data = {\r\n\t\t\tclassname:this.classname,\r\n\t\t\tuid:localStorage.getItem(\"login\"),\r\n\t\t}\r\n\t\t// console.log(\"data-------------------\"+data);\r\n\t\tthis.$ajax.post('/api/classify/getCid', this.$qs.stringify(data))\r\n\t\t.then(response => {\r\n\t\t\tconsole.log(\"cid-----\"+response.data);\r\n\t\t\tthis.cid = response.data;\r\n\t\t})\r\n\t\t.catch(error =>{\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t},\r\n\t// 测试看看显示不显示新添加的\r\n\tqueryAllClass(){\r\n\t\tconsole.log(\"queryAllClass被点击----------\");\r\n\t\tlet data = {\r\n\t\t\tuid:localStorage.getItem(\"login\")\r\n\t\t}\r\n\t\tconsole.log(\"data------------------------\"+data);\r\n\t\t//测试获取后端分类list\r\n\t\tthis.$ajax.post('/api/classify/allClassify',this.$qs.stringify(data))\r\n\t\t.then(response => {\r\n\t\t\t// console.log(response.data);\r\n\t\t\tthis.list = response.data;\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t},\r\n\tsell(){\t//点击发布文章\r\n\t\t//获取分类名的对应id\r\n\t\tif(!this.classname){\r\n\t\t\talert(\"请选择分类\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this.bid == 0){\t\t//新增博客\r\n\t\t\tthis.sellAddBlog();\r\n\t\t}\r\n\t\telse{\t\t//修改博客\r\n\t\t\tthis.updateBlog();\r\n\t\t}\r\n\t\t$('#myModal').modal('hide');\t//模态框隐藏\r\n\t\tvar that = this;\r\n\t\t// that.$router.push(`myBlogCenter${this.loginUid}`);\r\n\t\tthis.$router.go(-1);\r\n\t},\r\n\t//编辑博客后的更新博客\r\n\tupdateBlog(){\r\n\t\tlet data={\r\n\t\t\tid:this.bid,\r\n\t\t\t// userId:localStorage.getItem(\"login\"),\r\n\t\t\ttitle:this.myBlog.title,\r\n\t\t\tcontent:this.myValue,\r\n\t\t\tcid:this.cid,\r\n\t\t}\r\n\t\tthis.$ajax.post('/api/blog/updateBlog', this.$qs.stringify(data))\r\n\t\t.then(response =>{\r\n\t\t\t// console.log(\"====================\");\r\n\t\t\t// this.$router.push(`myBlogCenter${this.loginUid}`);\r\n\t\t\tthis.$router.go(-1);\r\n\t\t})\r\n\t\t.catch(error =>{\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t\t\r\n\t},\r\n\t\r\n\t//----新增博客\r\n\tsellAddBlog(){\r\n\t\t//新增博客\r\n\t\tconsole.log(\"新增博客-------\");\r\n\t\tvar title = this.myBlog.title;\r\n\t\tvar content = this.myValue;\r\n\t\tvar cId = this.cid;\r\n\t\t// console.log(\"cId--------\"+cId);\r\n\t\tlet data ={\r\n\t\t\tuserId:localStorage.getItem(\"login\"),\r\n\t\t\ttitle:title,\r\n\t\t\tcontent:content,\r\n\t\t\tcid:cId\r\n\t\t}\r\n\t\tthis.$ajax.post('/api/blog/addBlog',this.$qs.stringify(data))\r\n\t\t.then(response =>{\r\n\t\t\talert(\"发布成功\");\r\n\t\t})\r\n\t\t.catch(error =>{\r\n\t\t\tconsole.log(error);\r\n\t\t})\r\n\t},\r\n\t\r\n\t\n  },\n  \n}\n</script>\r\n\r\n<style>\r\n\t.editor-form{\r\n\t\tmargin: 10px 0 0 100px;\r\n\t\t/* width: 50%; */\r\n\t}\r\n\t.editor-form>span{\r\n\t\tcolor: red;\r\n\t\tfont-weight: bold;\r\n\t\twidth: 16px;\r\n\t}\r\n\t.editor-title{\r\n\t\tdisplay: inline-block;\r\n\t\tmargin-left: 20px;\r\n\t\t/* margin-right: 10px; */\r\n\t\tfloat: left;\r\n\t\twidth: 83%;\r\n\t\t\r\n\t\theight: 34px;\r\n\t\tpadding: 6px 12px;\r\n\t\tfont-size: 14px;\r\n\t\tline-height: 1.42857143;\r\n\t\tcolor: #555;\r\n\t\tbackground-color: #fff;\r\n\t\tbackground-image: none;\r\n\t\tborder: 1px solid #ccc;\r\n\t\tborder-radius: 4px;\r\n\t\tbox-shadow: inset 0 1px 1px rgba(0,0,0,.075);\r\n\t\ttransition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;\r\n\t}\r\n\t.editor-btnOut{\r\n\t\tmargin-left: 10px;\r\n\t\t/* float: left; */\r\n\t\t/* float: left; */\r\n\t}\r\n\t.editor-help{\r\n\t\theight: 10px;\r\n\t\twidth: 100%;\r\n\t}\r\n\t.form-mygroup{\r\n\t\tmin-height: 45px;\r\n\t}\r\n\t/* 输入框----创建新分类 */\r\n\t\r\n\t#classnameId{\r\n\t\twidth: 80%;\r\n\t\tfloat: left;\r\n\t}\r\n\t/* 选择已有分类 */\r\n\t#selectclass{\r\n\t\twidth:50%;\r\n\t\tmargin-left: 20px;\r\n\t\tdisplay: inline;\r\n\t\tfloat: left;\r\n\t\tmargin-left: 15px;\r\n\t}\r\n\t/* 按钮----确定 */\r\n\t.btn-confirm{\r\n\t\tfloat: right;\r\n\t\tdisplay: inline;\r\n\t}\r\n\t/* 分类名 */\r\n\t.modal-blogclassname{\r\n\t\tline-height: 34px;\r\n\t}\r\n\t.choose-classname{\r\n\t\t/* float: left; */\r\n\t\ttext-align: left;\r\n\t\tmargin-left: 110px;\r\n\t}\r\n\t.dropmenu{\r\n\t\tmin-width: 120px;\r\n\t\ttext-align: left;\r\n\t}\r\n\t.dropmenu>li{\r\n\t\ttext-align: left;\r\n\t\tpadding-left: 20px;\r\n\t\tmin-width: 80px;\r\n\t}\r\n\t\r\n</style>\n"],"sourceRoot":"src/components"}]}